<html>

<head>
    <title>स्वर स्थानान्तरण साधन</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@600;700&display=swap" rel="stylesheet">
</head>

<style>
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

:root {
  --primary-background: #FFE6B7;
  --primary-color: #FF2E00;
  --primary-accent: #FF8A5B;
  --primary-accent-alpha: #FF8A5B33;
}

body {
  font-family: 'Poppins', sans-serif;
  background: var(--primary-background);
  color: var(--primary-color);
}

a {
  color: inherit;
  text-decoration: none;
}

input, textarea, select, button {
  outline: none;
  border: none;
  background: rgba(0, 0, 0, 0);
  border: solid 1px var(--primary-accent);
  border-radius: 5px;
}

input, textarea, select {
  background: var(--primary-accent-alpha);
  padding: 0.5em 1em;
}

button {
  background: var(--primary-color);
  color: var(--primary-background);
  padding: 0.5em 2em;
  cursor: pointer;
}

nav .wrapper{
  width: 1500px;
  max-width: 90vw;
  margin: 0 auto;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.logo {
  font-size: 1.5em;
  font-weight: 700;
}

.source {
  display: flex;
  gap: 1em;
  align-items: center;
  padding: 0.5em 1em;
  font-size: 1.2em;
}

.content-wrapper {
  width: 1200px;
  max-width: 90vw;
  margin: 0 auto;
}

.tab-bar {
  display: flex;
  gap: 0.5em;
}

.tab-bar > div {
  flex: 1;
  display: flex;
  justify-content: center;
  padding: 0.5em 0;
  border-bottom: 8px solid var(--primary-accent-alpha);
  cursor: pointer;
}

.tab-wrapper {
  display: flex;
  flex-wrap: wrap;
}

.main-content {
  flex: 1;
}
</style>

<body>

  <nav>
    <div class="wrapper">
      <div class="logo">स्थानांतरण</div>
      <a href="https://github.com/costomato/swar-sthaanaantaran-saadhan" class="source">
        स्रोत
        <img src="github.svg" alt="github">
      </a>
    </div>
  </nav>

  <div class="content-wrapper">

    <div class="tab-bar">
      <div class="transpose-tab">Transpose</div>
      <div class="translate-tab">Translate</div>
    </div>

    <div class="tab-wrapper">
      <div class="main-content">
        <h1>Music Transposer</h1>
        <form id="transpose-form">
          <label for="music">Music:</label>
          <br>
          <textarea id="music" rows="10" cols="50"></textarea>
          <br>
          <label for="semitones">Semitones:</label>
          <br>
          <input type="number" id="semitones" min="-12" max="12">
          <br>
          <br>
          <button type="submit">Transpose</button>
        </form>
        <div id="output"></div>
      </div>

      <div class="main-content">
        <h1>Music Converter</h1>
        <form id="convert-form">
          <label for="music">Music:</label>
          <br>
          <textarea id="music-convert" rows="10" cols="50"></textarea>
          <br>
          <br>
          <label for="direction">Direction:</label>
          <br>
          <select id="direction">
            <option value="western-to-indian">Western to Indian</option>
            <option value="indian-to-western">Indian to Western</option>
          </select>
          <br>
          <br>
          <button type="submit">Convert</button>
        </form>
        <div id="output-conv"></div>
      </div>
    </div>

  </div>
    <script>
        const SEMITONES_PER_OCTAVE = 12;

        function transpose(music, semitones) {
            // split the music into an array of notes
            let notes = music.replace(/\n/g, " ").split(' ');

            // transpose each note by the given number of semitones
            let transposedNotes = notes.map(note => {
                let pitch = note.replace(/[^A-Za-z#]/g, '');
                let octave = parseInt(note.replace(/[^0-9]/g, ''));
                let transposedPitch = (SEMITONES_PER_OCTAVE + pitchToNumber(pitch) + semitones) % SEMITONES_PER_OCTAVE;
                let transposedOctave = octave + Math.floor((pitchToNumber(pitch) + semitones) / SEMITONES_PER_OCTAVE);
                return numberToPitch(transposedPitch) + transposedOctave;
            });

            // join the transposed notes into a single string
            return transposedNotes.join(' ');
        }

        function pitchToNumber(pitch) {
            switch (pitch.toUpperCase()) {
                case 'C': return 0;
                case 'C#': case 'Db': return 1;
                case 'D': return 2;
                case 'D#': case 'Eb': return 3;
                case 'E': return 4;
                case 'F': return 5;
                case 'F#': case 'Gb': return 6;
                case 'G': return 7;
                case 'G#': case 'Ab': return 8;
                case 'A': return 9;
                case 'A#': case 'Bb': return 10;
                case 'B': return 11;
            }
        }

        function numberToPitch(number) {
            switch (number) {
                case 0: return 'C';
                case 1: return 'C#';
                case 2: return 'D';
                case 3: return 'D#';
                case 4: return 'E';
                case 5: return 'F';
                case 6: return 'F#';
                case 7: return 'G';
                case 8: return 'G#';
                case 9: return 'A';
                case 10: return 'A#';
                case 11: return 'B';
            }
        }

        let form = document.getElementById('transpose-form');
        form.addEventListener('submit', event => {
            event.preventDefault();
            let music = document.getElementById('music').value;
            let semitones = parseInt(document.getElementById('semitones').value);
            let output = document.getElementById('output');
            output.innerHTML = transpose(music, semitones);
        });

        // music conversion functions
        function westernToIndian(note) {
            switch (note.toUpperCase()) {
                case 'C': return 'Sa';
                case 'C#': case 'Db': return 're';
                case 'D': return 'Re';
                case 'D#': case 'Eb': return 'ga';
                case 'E': return 'Ga';
                case 'F': return 'ma';
                case 'F#': case 'Gb': return 'Ma';
                case 'G': return 'Pa';
                case 'G#': case 'Ab': return 'dha';
                case 'A': return 'Dha';
                case 'A#': case 'Bb': return 'ni';
                case 'B': return 'Ni';
            }
        }

        function indianToWestern(note) {
            switch (note) {
                case 'Sa': case 'S': return 'C';
                case 're': case 'r': return 'C#';
                case 'Re': case 'R': return 'D';
                case 'ga': case 'g': return 'D#';
                case 'Ga': case 'G': return 'E';
                case 'ma': case 'm': return 'F';
                case 'Ma': case 'M': return 'F#';
                case 'Pa': case 'P': return 'G';
                case 'dha': case 'd': return 'G#';
                case 'Dha': case 'D': return 'A';
                case 'ni': case 'n': return 'A#';
                case 'Ni': case 'N': return 'B';
            }
        }

        function convert() {
            // get the input music and conversion direction
            let input = document.getElementById('music-convert').value;
            let direction = document.getElementById('direction').value;

            // split the input into an array of individual notes
            let notes = input.replace(/\n/g, " ").split(' ');

            // convert each note
            let output = '';
            if (direction === 'western-to-indian') {
                // convert each note
                let convertedNotes = notes.map(note => {
                    // let pitch = note.substring(0, note.length - 1);
                    let pitch = note.replace(/[^A-Za-z#]/g, '');
                    // let octave = note.substring(note.length - 1);
                    let octave = note.replace(/[^0-9]/g, '');
                    return westernToIndian(pitch) + octave;
                });
                output = convertedNotes.join(' ');
            } else {
                let convertedNotes = notes.map(note => {
                    // let pitch = note.substring(0, note.length - 1);
                    let pitch = note.replace(/[^A-Za-z]/g, '');
                    // let octave = note.substring(note.length - 1);
                    let octave = note.replace(/[^0-9]/g, '');
                    return indianToWestern(pitch) + octave;
                });
                output = convertedNotes.join(' ');
            }
            // display the output
            document.getElementById('output-conv').innerHTML = output;
        }

        // register the form submit handler
        let form2 = document.getElementById('convert-form');
        form2.addEventListener('submit', event => {
            event.preventDefault();
            convert();
        });
    </script>
</body>

</html>
